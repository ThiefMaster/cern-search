import json

import pytest
import requests

HEADERS = {
    "Accept": "application/json",
    "Content-Type": "application/json; charset=utf-8",
    "Authorization": ''
}

BINARY_CONTENT = "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"
# DUMMY: e1xydGYxXGFuc2kNCkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0DQpccGFyIH0

@pytest.mark.unit
def test_binary_es_ocr(endpoint, api_key):
    HEADERS['Authorization'] = 'Bearer {credentials}'.format(credentials=api_key)

    body = {
        "_access": {
            "owner": ["CernSearch-Administrators@cern.ch"],
            "update": ["CernSearch-Administrators@cern.ch"],
            "delete": ["CernSearch-Administrators@cern.ch"]
        },
        "title": "Test binary",
        "description": "Test binary with ingest pipeline",
        "link": "localhost/test",
        "b64": "{binary_content}".format(binary_content=BINARY_CONTENT),
        "$schema": "{endpoint}/schemas/cernsearch-test/binary_v0.0.1.json".format(
            endpoint=endpoint
        )
    }

    # Create test record
    resp = requests.post('{endpoint}/api/records/'.format(endpoint=endpoint),
                         headers=HEADERS, data=json.dumps(body))

    assert resp.status_code == 201

    # Check non presence of OCR content in DB record
    resp_body = resp.json()['metadata']
    assert resp_body.get('content') is None  # Content is the target field in ES pipeline
    assert resp_body.get('control_number') is not None
    assert resp_body.get('title') == 'Test binary'
    assert resp_body.get('description') == 'Test binary with ingest pipeline'
    assert resp_body.get('link') == 'localhost/test'
    assert resp_body.get('b64') == "{binary_content}".format(binary_content=BINARY_CONTENT)

    control_number = resp_body.get("control_number")
    # Search record
    # Create test record
    resp = requests.get('{endpoint}/api/records/?q=control_number:{control_number}'
                        .format(endpoint=endpoint, control_number=control_number),
                        headers=HEADERS, data=json.dumps(body))

    assert resp.status_code == 200

    resp_hits = resp['hits']
    assert resp_hits.get('total') == '1'

    content = resp_hits['hits'][0].get('content')
    assert content is not None
    assert content.get('content') == "Lorem ipsum dolor sit amet"
    assert content.get('content_length') == '28'
    assert content.get('content_type') == 'application/rtf'
    assert content.get('language') == 'ro'
